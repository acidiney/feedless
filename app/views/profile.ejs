<%- include('_header') %>

<div class="columns">
  <div class="about">
    <img class="profile-pic" src="<%= profileImageUrl(profile) %>" />
    <h1><%= profile.name %></h1>

    <%= profile.description %>

    <div style="margin-top: 20px">
      <% if (friendshipStatus == "no_relation") { %>
        <form action="<%= profileUrl(profile.id, "/add_friend") %>" method="POST">
          <input type="submit" value="Add as friend" />
        </form>
      <% } else if (friendshipStatus == "friends") { %>
        âœ… Friends
        <form action="<%= profileUrl(profile.id, "/reject_friend") %>" style="display:inline; margin-left: 15px" method="POST">
          <input type="submit" class="button-secondary" value="unfriend" />
        </form>
      <% } else if (friendshipStatus == "request_sent") { %>
        <button disabled>Request sent</button>
      <% } else if (friendshipStatus == "request_received") { %>
        <p><%= profile.name %> sent you a friendship request</p>
        <form action="<%= profileUrl(profile.id, "/add_friend") %>" style="display:inline" method="POST">
          <input type="submit" value="Accept" />
        </form>
        <form action="<%= profileUrl(profile.id, "/reject_friend") %>" style="display:inline" method="POST">
          <input type="submit" class="button-secondary" value="Reject" />
        </form>
      <% } else if (friendshipStatus == "request_rejected") { %>
        <p>You rejected <%= profile.name %> friendship request</p>
        <form action="<%= profileUrl(profile.id, "/add_friend") %>" method="POST">
          <input type="submit" value="Add as friend" />
        </form>
      <% } %>
    </div>

    <h2>Friends</h2>

    <ul>
      <% friends.friends.map(friend => { %>
        <li>
          <a href="<%= profileUrl(friend.id) %>">
            <%= friend.name %> (<%= friend.id.slice(0, 8) %>)
          </a>
        </li>
      <% }) %>
    </ul>
  </div>

  <div class="wall">
    <h1><%= profile.name %>'s Wall</h1>

    <h2>Leave <%= profile.name %> a message</h2>
    <form action="<%= profileUrl(profile.id, "/publish") %>" method="POST">
      <div>
        <label>
          <input type="radio" name="visibility" value="public" checked=checked>
          Public
        </label>
        <label>
          <input type="radio" name="visibility" value="vanishing">
          Vanishing
        </label>
      </div>
      <textarea name="message"></textarea>
      <input type="submit" value="Send" />
    </form>

    <% posts.map(post => { %>
      <%- include('_post', { post }) %>
    <% }) %>
  </div>
</div>

<%- include('_footer') %>